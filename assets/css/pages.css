/* =======================================================================
   WP + BuddyBoss + TutorLMS — Editorial Pages (alineado con hoja anterior)
   Accesibilidad, dark mode, MathJax, tipografía y responsivo coherentes
   ======================================================================= */

/* -----------------------------------------------------------------------
   SAFETY NET: fallbacks para tokens (no interfieren si ya existen)
   ----------------------------------------------------------------------- */
:root {
  /* Anchuras de página */
  --page-width-narrow: 1000px;
  --page-width-standard: 1400px;
  --page-width-wide: 1600px;
  --page-width-full: 100%;

  /* Espaciado y ritmo */
  --space-1: .25rem;
  --space-2: .5rem;
  --space-3: .75rem;
  --space-4: 1rem;
  --space-5: 1.25rem;
  --space-6: 1.5rem;
  --space-8: 2rem;
  --space-10: 2.5rem;
  --space-12: 3rem;
  --space-14: 3.5rem;
  --space-16: 4rem;
  --space-20: 5rem;

  --page-padding: clamp(var(--space-6), 5vw, var(--space-12));
  --page-section-gap: var(--space-20);
  --page-content-gap: var(--space-10);

  /* Colores base coherentes con hoja editorial anterior */
  --color-background: #f8fafc;
  --color-surface: #ffffff;
  --color-surface-elevated: #ffffff;
  --color-border: #e5e7eb;
  --color-border-strong: #cbd5e1;
  --color-border-light: #eef2f7;
  --color-text-primary: #0f172a;
  --color-text-secondary: #334155;
  --color-text-muted: #64748b;

  --color-primary-50: #eef2ff;
  --color-primary-200: #c7d2fe;
  --color-primary-300: #a5b4fc;
  --color-primary-400: #818cf8;
  --color-primary-500: #6366f1;
  --color-primary-600: #4f46e5;
  --color-primary-700: #4338ca;
  --color-primary-800: #3730a3;

  --color-primary: var(--color-primary-600);
  --color-primary-hover: var(--color-primary-500);

  /* Paletas semáforo (alertas) + fondos */
  --color-info: #2563eb;
  --color-info-200: #bfdbfe;
  --color-info-bg: #eff6ff;
  --color-success: #16a34a;
  --color-success-200: #bbf7d0;
  --color-success-bg: #f0fdf4;
  --color-warning: #d97706;
  --color-warning-200: #fde68a;
  --color-warning-bg: #fffbeb;
  --color-error: #dc2626;
  --color-error-200: #fecaca;
  --color-error-bg: #fef2f2;

  /* Tipografías y pesos */
  --font-family-serif: ui-serif, "Ibarra Real Nova", "Source Serif Pro", "Georgia", serif;
  --font-family-sans: ui-sans-serif, "Inter", "SF Pro Text", "Segoe UI", Roboto, sans-serif;
  --font-family-display: var(--font-family-serif);
  --font-family-mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;

  --font-size-xs: .75rem;
  --font-size-sm: .875rem;
  --font-size-base: 1rem;
  --font-size-lg: 1.125rem;
  --font-size-xl: 1.25rem;

  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  --font-weight-black: 900;

  --line-height-tight: 1.2;
  --line-height-relaxed: 1.7;

  /* Radios y sombras */
  --radius-sm: .375rem;
  --radius-md: .5rem;
  --radius-lg: .75rem;
  --radius-xl: 1rem;
  --radius-2xl: 1.25rem;
  --radius-full: 999px;

  --shadow-sm: 0 1px 2px rgba(0, 0, 0, .05);
  --shadow-md: 0 6px 24px rgba(0, 0, 0, .08);
  --shadow-lg: 0 16px 48px rgba(0, 0, 0, .12);
  --shadow-xl: 0 22px 64px rgba(0, 0, 0, .16);

  /* Transiciones y layout */
  --transition-fast: .18s ease;
  --transition-normal: .28s ease;
  --transition-timing: cubic-bezier(.2, .8, .2, 1);
  --header-height: 72px;

  /* Gradientes coherentes */
  --gradient-primary: linear-gradient(90deg, var(--color-primary-600), var(--color-primary-400));
  --gradient-text: linear-gradient(90deg, var(--color-primary-700), var(--color-primary-400));
}

/* -----------------------------------------------------------------------
     TutorLMS single course — preservar layout del plugin (mínimos overrides)
     ----------------------------------------------------------------------- */
.single-courses .pagina-wrapper,
.single-courses .page-container,
.single-courses .site-main {
  background: transparent;
  padding: 0;
}

.single-courses .page-content,
.single-courses .page-content-wrapper,
.single-courses .page-main-content {
  background: transparent;
  border: 0;
  box-shadow: none;
  padding: 0;
}

/* -----------------------------------------------------------------------
     Layout principal de páginas (WP/BuddyBoss) — limpio y editorial
     ----------------------------------------------------------------------- */
.pagina-wrapper {
  min-block-size: calc(100vh - var(--header-height) - 200px);
  padding-block: var(--space-6);
  background: var(--color-background);
}

.page-container {
  max-inline-size: var(--page-width-wide);
  margin-inline: auto;
  padding-inline: var(--page-padding);
  position: relative;
}

.page-container--narrow {
  max-inline-size: var(--page-width-narrow);
}

.page-container--wide {
  max-inline-size: var(--page-width-wide);
}

.page-container--full {
  max-inline-size: var(--page-width-full);
}

.site-main {
  padding-block-start: var(--header-height);
  /* header fijo compensado */
  background: inherit;
  position: relative;
}

/* Contenedor editorial del contenido (entradas/páginas/lessons) */
.page-content,
.page-main-content {
  background: transparent;
}

.page-content-wrapper,
.entrada-simple .page-content-wrapper {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
  border: 1px solid var(--color-border);
  max-inline-size: 1100px;
  margin-inline: auto;
  padding-inline: var(--space-6);
}

/* -----------------------------------------------------------------------
     Tipografía y ritmo para contenido de WP y lecciones (identidad previa)
     ----------------------------------------------------------------------- */
:where(.wp-block-post-content,
  .entry-content,
  .page-content,
  .page-content-wrapper,
  .contenido-principal,
  .lesson-content-wrapper,
  .leccion-contenido) {
  font-family: var(--font-family-serif);
  font-size: var(--font-size-lg);
  line-height: var(--line-height-relaxed);
  color: var(--color-text-primary);
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  text-wrap: pretty;
  padding-block: var(--space-8);
}

:where(.contenido-principal, .leccion-contenido) {
  max-inline-size: 100%;
  margin-inline: auto;
  padding-inline: var(--space-6);
}

/* Ritmo vertical básico */
:where(.wp-block-post-content, .entry-content, .page-content-wrapper)>* {
  margin-block-end: var(--space-4);
}

/* Encabezados */
:where(.wp-block-post-content, .entry-content, .page-content-wrapper) h1,
:where(.contenido-principal, .leccion-contenido) h1 {
  font-family: var(--font-family-serif);
  font-weight: var(--font-weight-black);
  letter-spacing: -0.025em;
  line-height: 1.2;
  margin: var(--space-16) 0 var(--space-8);
  font-size: clamp(2rem, 4vw, 2.75rem);
  position: relative;
  padding-block-end: var(--space-4);
  background: var(--gradient-text);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) h1::after,
:where(.contenido-principal, .leccion-contenido) h1::after {
  content: '';
  position: absolute;
  inset-inline-start: 0;
  inset-block-end: 0;
  inline-size: 60px;
  block-size: 3px;
  background: var(--gradient-primary);
  border-radius: var(--radius-full);
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) h2,
:where(.contenido-principal, .leccion-contenido) h2 {
  font-weight: var(--font-weight-bold);
  font-size: clamp(1.6rem, 3vw, 2.25rem);
  line-height: 1.25;
  color: var(--color-text-primary);
  position: relative;
  margin: var(--space-14) 0 var(--space-6);
  padding-inline-start: var(--space-6);
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) h2::before,
:where(.contenido-principal, .leccion-contenido) h2::before {
  content: '';
  position: absolute;
  inset-inline-start: 0;
  inset-block: 0;
  inline-size: 4px;
  background: var(--gradient-primary);
  border-radius: var(--radius-full);
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) h3,
:where(.contenido-principal, .leccion-contenido) h3 {
  font-size: clamp(1.35rem, 2.5vw, 1.875rem);
  font-weight: var(--font-weight-bold);
  margin: var(--space-12) 0 var(--space-5);
}

/* Párrafos y listas */
:where(.wp-block-post-content, .entry-content, .page-content-wrapper) p,
:where(.contenido-principal, .leccion-contenido) p {
  margin-block-end: var(--space-6);
  text-align: justify;
  hyphens: auto;
  -webkit-hyphens: auto;
  hyphenate-limit-chars: 6 3 3;
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) ul,
:where(.wp-block-post-content, .entry-content, .page-content-wrapper) ol,
:where(.contenido-principal, .leccion-contenido) ul,
:where(.contenido-principal, .leccion-contenido) ol {
  margin-block-end: var(--space-6);
  padding-inline-start: var(--space-8);
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) li,
:where(.contenido-principal, .leccion-contenido) li {
  margin-block: var(--space-3);
  line-height: var(--line-height-relaxed);
}

/* Citas editoriales coherentes */
:where(.wp-block-post-content, .entry-content, .page-content-wrapper, .contenido-principal, .leccion-contenido) blockquote {
  border: none;
  border-inline-start: 6px solid var(--color-primary);
  background: var(--color-primary-50);
  padding: var(--space-8);
  margin: var(--space-8) 0;
  border-radius: 0 var(--radius-xl) var(--radius-xl) 0;
  font-style: italic;
  font-size: var(--font-size-xl);
  color: var(--color-text-secondary);
  position: relative;
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) blockquote::before,
:where(.contenido-principal, .leccion-contenido) blockquote::before {
  content: '“';
  font-size: 3.5rem;
  color: var(--color-primary);
  position: absolute;
  inset-block-start: var(--space-3);
  inset-inline-start: var(--space-4);
  line-height: 1;
}

/* Código y preformateado */
:where(.wp-block-post-content, .entry-content, .page-content-wrapper) code,
:where(.contenido-principal, .leccion-contenido) code {
  font-family: var(--font-family-mono);
  background: color-mix(in srgb, var(--color-primary-600) 8%, #fff);
  color: var(--color-text-primary);
  padding: .15em .35em;
  border-radius: .35em;
  border: 1px solid var(--color-border);
  font-size: .95em;
}

/* =======================================
   ESTILOS DE CÓDIGO LIMPIO - HIGHLIGHT.JS
   ======================================= */

/* Estilos base para bloques de código - MINIMALISTA */
pre {
  margin: var(--space-8) 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  /* SIN bordes, sombras ni decoraciones innecesarias */
}

pre code {
  display: block;
  padding: var(--space-6);
  overflow-x: auto;
  font-family: 'Fira Code', 'Cascadia Code', 'Source Code Pro', 'Monaco', 'Menlo', 'Consolas', monospace;
  font-size: 0.9em;
  line-height: 1.5;
  /* NO forzar background ni color - highlight.js los controla */
}

/* Código inline */
:not(pre) > code {
  background: var(--color-surface-elevated);
  color: var(--color-primary);
  padding: 0.2em 0.4em;
  border-radius: 4px;
  font-size: 0.85em;
  border: 1px solid var(--color-border);
  font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
}

/* =======================================
   HIGHLIGHT.JS TEMA MONOKAI PROFESIONAL
   ======================================= */

/* MONOKAI TEMA PURO - SIN DECORACIONES */
.hljs {
  background: #272822 !important;
  color: #f8f8f2 !important;
  /* Sin bordes redondeados ni sombras - Monokai original */
}

/* Colores Monokai originales */
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-section,
.hljs-link {
  color: #f92672 !important; /* Rosa/Magenta */
  font-weight: 500;
}

.hljs-function .hljs-keyword {
  color: #66d9ef !important; /* Cyan */
}

.hljs-subst {
  color: #f8f8f2 !important;
}

.hljs-string,
.hljs-title,
.hljs-name,
.hljs-type,
.hljs-attribute,
.hljs-symbol,
.hljs-bullet,
.hljs-addition,
.hljs-variable,
.hljs-template-tag,
.hljs-template-variable {
  color: #e6db74 !important; /* Amarillo */
}

.hljs-comment,
.hljs-quote,
.hljs-deletion,
.hljs-meta {
  color: #75715e !important; /* Gris */
  font-style: italic;
}

.hljs-number,
.hljs-regexp,
.hljs-literal {
  color: #ae81ff !important; /* Violeta */
}

.hljs-built_in,
.hljs-builtin-name,
.hljs-class .hljs-title {
  color: #a6e22e !important; /* Verde */
  font-weight: 500;
}

.hljs-function,
.hljs-function .hljs-title,
.hljs-title.hljs-function {
  color: #a6e22e !important; /* Verde para funciones */
  font-weight: 600;
}

.hljs-attr,
.hljs-variable,
.hljs-property {
  color: #f8f8f2 !important; /* Blanco */
}

.hljs-tag {
  color: #f92672 !important; /* Rosa */
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

/* =======================================
   NUMERACIÓN DE LÍNEAS LIMPIA
   ======================================= */

.line-numbers-mode {
  display: flex !important;
  align-items: stretch !important;
  font-family: 'Fira Code', 'Cascadia Code', 'Source Code Pro', monospace !important;
}

.line-numbers {
  background: #49483e !important; /* Más sutil que el código */
  color: #75715e !important;
  padding: 1rem 0.75rem !important;
  font-size: 0.9em !important;
  line-height: 1.5 !important;
  user-select: none !important;
  display: flex !important;
  flex-direction: column !important;
  min-width: 3rem !important;
  text-align: right !important;
  /* Sin bordes ni decoraciones */
}

.line-number {
  display: block !important;
  line-height: 1.5 !important;
  color: #75715e !important;
  font-weight: 400 !important;
  /* Sin transitions ni efectos */
}

.line-numbers-mode .hljs {
  flex: 1 !important;
  margin: 0 !important;
  padding: 1rem !important;
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) pre code,
:where(.contenido-principal, .leccion-contenido) pre code {
  background: transparent;
  color: inherit;
  padding: 0;
  border: 0;
  font-size: var(--font-size-base);
}

/* Figuras y multimedia */
:where(.wp-block-post-content, .entry-content, .page-content-wrapper) img,
:where(.contenido-principal, .leccion-contenido) img {
  max-inline-size: 100%;
  block-size: auto;
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  margin-block: var(--space-8);
  transition: transform var(--transition-normal), box-shadow var(--transition-normal);
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) img:hover {
  transform: scale(1.02);
  box-shadow: var(--shadow-xl);
}

.page-content-wrapper figure {
  margin: var(--space-8) 0;
  text-align: center;
}

.page-content-wrapper figcaption {
  margin-block-start: var(--space-4);
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
  font-style: italic;
  text-align: center;
}

/* Vídeos responsivos */
.page-content-wrapper .video-container {
  position: relative;
  inline-size: 100%;
  aspect-ratio: 16/9;
  margin: var(--space-8) 0;
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-xl);
}

.page-content-wrapper .video-container :is(iframe, video) {
  position: absolute;
  inset: 0;
  inline-size: 100%;
  block-size: 100%;
  border: none;
}

/* Tablas */
.page-content-wrapper table {
  inline-size: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin: var(--space-8) 0;
  background: var(--color-surface-elevated);
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-md);
}

.page-content-wrapper th,
.page-content-wrapper td {
  padding: var(--space-4) var(--space-6);
  text-align: start;
  border-bottom: 1px solid var(--color-border);
}

.page-content-wrapper thead th {
  position: sticky;
  inset-block-start: 0;
  background: var(--color-primary-50);
  color: var(--color-primary);
  font-weight: var(--font-weight-semibold);
  font-size: var(--font-size-sm);
  text-transform: uppercase;
  letter-spacing: .05em;
}

.page-content-wrapper tr:hover {
  background: #f1f5f9;
}

/* Enlaces y foco accesible (coherente con identidad) */
.page-content-wrapper a {
  color: var(--color-primary);
  text-decoration: underline;
  text-underline-offset: .15em;
  font-weight: var(--font-weight-medium);
  border-bottom: 2px solid transparent;
  transition: color var(--transition-fast), border-color var(--transition-fast);
}

.page-content-wrapper a:hover {
  color: var(--color-primary-hover);
  border-bottom-color: var(--color-primary-hover);
}

*:focus-visible {
  outline: 2px solid color-mix(in srgb, var(--color-primary-600) 70%, transparent);
  outline-offset: 2px;
  border-radius: .25rem;
}

/* Navegación siguiente/anterior */
.page-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-6);
  margin-block-start: var(--space-16);
  padding: var(--space-8);
  background: #f1f5f9;
  border-radius: var(--radius-xl);
  border: 1px solid var(--color-border);
}

.page-nav-link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-3);
  padding: var(--space-4) var(--space-6);
  background: var(--color-surface-elevated);
  border: 2px solid var(--color-border);
  border-radius: var(--radius-xl);
  color: var(--color-text-primary);
  text-decoration: none;
  font-weight: var(--font-weight-semibold);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast), border-color var(--transition-fast);
  min-inline-size: 160px;
  box-shadow: var(--shadow-sm);
}

.page-nav-link:hover {
  background: var(--color-primary-50);
  border-color: var(--color-primary-200);
  color: var(--color-primary);
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.page-nav-link--prev {
  flex-direction: row;
}

.page-nav-link--next {
  flex-direction: row-reverse;
}

/* Alertas */
.page-alert {
  padding: var(--space-6) var(--space-8);
  border-radius: var(--radius-xl);
  margin: var(--space-8) 0;
  border: 2px solid;
  display: flex;
  align-items: flex-start;
  gap: var(--space-4);
  box-shadow: var(--shadow-md);
}

.page-alert--info {
  background: var(--color-info-bg);
  border-color: var(--color-info-200);
  color: var(--color-info);
}

.page-alert--success {
  background: var(--color-success-bg);
  border-color: var(--color-success-200);
  color: var(--color-success);
}

.page-alert--warning {
  background: var(--color-warning-bg);
  border-color: var(--color-warning-200);
  color: var(--color-warning);
}

.page-alert--error {
  background: var(--color-error-bg);
  border-color: var(--color-error-200);
  color: var(--color-error);
}

.page-alert-icon {
  font-size: var(--font-size-xl);
  flex-shrink: 0;
  margin-block-start: var(--space-1);
}

.page-alert-title {
  font-weight: var(--font-weight-bold);
  margin-block-end: var(--space-2);
  font-size: var(--font-size-lg);
}

.page-alert-message {
  margin: 0;
}

/* Sidebar */
.page-with-sidebar {
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: var(--space-8);
  align-items: start;
}

.page-sidebar {
  position: sticky;
  inset-block-start: calc(var(--header-height) + var(--space-6));
  max-block-size: calc(100vh - var(--header-height) - var(--space-12));
  overflow-y: auto;
}

.sidebar-widget {
  background: var(--color-surface-elevated);
  border-radius: var(--radius-2xl);
  border: 1px solid var(--color-border);
  box-shadow: var(--shadow-md);
  margin-block-end: var(--space-6);
  overflow: hidden;
  transition: box-shadow var(--transition-normal), transform var(--transition-normal);
}

.sidebar-widget:hover {
  box-shadow: var(--shadow-lg);
  transform: translateY(-1px);
}

.sidebar-widget-header {
  background: #f1f5f9;
  padding: var(--space-4) var(--space-6);
  border-bottom: 1px solid var(--color-border);
}

.sidebar-widget-title {
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-bold);
  color: var(--color-text-primary);
  margin: 0;
  text-transform: uppercase;
  letter-spacing: .05em;
}

.sidebar-widget-content {
  padding: var(--space-6);
}

/* -----------------------------------------------------------------------
     Header de página (sólo en páginas)
     ----------------------------------------------------------------------- */
.page .page-header {
  background: var(--color-surface);
  padding-block: var(--space-8) var(--space-4);
  border-bottom: 1px solid var(--color-border);
  text-align: center;
}

.page .page-header::before {
  display: none;
}

.page .page-header__title,
.page-title {
  font-family: var(--font-family-display);
  font-size: clamp(2.5rem, 5vw, 4rem);
  font-weight: var(--font-weight-bold);
  color: var(--color-text-primary);
  margin: 0 0 var(--space-4) 0;
  line-height: 1.1;
  letter-spacing: -0.025em;
}

.page-subtitle {
  font-size: var(--font-size-xl);
  color: var(--color-text-secondary);
  font-weight: var(--font-weight-medium);
  line-height: var(--line-height-relaxed);
  max-inline-size: 60ch;
  margin: 0 auto;
}

.page .page-meta,
.page .page-header .meta,
.single .page-header .meta {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: var(--space-4);
  margin-block-start: var(--space-6);
  flex-wrap: wrap;
}

.page .page-meta-item,
.page .page-header .meta>*,
.single .page-header .meta>* {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  background: var(--color-surface-elevated);
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius-full);
  border: 1px solid var(--color-border);
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
  font-weight: var(--font-weight-medium);
}

/* -----------------------------------------------------------------------
     Responsivo
     ----------------------------------------------------------------------- */
@media (max-width: 1024px) {
  .page-with-sidebar {
    grid-template-columns: 1fr;
  }

  .page-sidebar {
    position: static;
    max-block-size: none;
    order: -1;
  }

  .sidebar-widget {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--space-6);
  }

  .sidebar-widget-header,
  .sidebar-widget-content {
    grid-column: 1 / -1;
  }
}

@media (max-width: 768px) {
  .page-container {
    padding-inline: var(--space-4);
  }

  .page .page-header {
    padding: var(--space-12) var(--space-6) var(--space-6);
  }

  .page-main-content {
    padding-block: var(--space-8);
  }

  .page-title {
    font-size: clamp(2rem, 6vw, 2.5rem);
  }

  .page-navigation {
    flex-direction: column;
    gap: var(--space-4);
  }

  .page-nav-link {
    inline-size: 100%;
    min-inline-size: auto;
  }

  :where(.wp-block-post-content, .entry-content, .page-content-wrapper) h2 {
    padding-inline-start: var(--space-4);
  }

  :where(.wp-block-post-content, .entry-content, .page-content-wrapper) h2::before {
    inline-size: 3px;
  }

  :where(blockquote) {
    padding: var(--space-6);
  }
}

@media (max-width: 640px) {
  .page-container {
    padding-inline: var(--space-3);
  }

  .page .page-header {
    padding: var(--space-8) var(--space-4) var(--space-4);
  }

  .page-content-wrapper {
    font-size: var(--font-size-base);
  }

  .page-content-wrapper :is(p, li) {
    font-size: var(--font-size-base);
    text-align: start;
  }

  .page-content-wrapper table {
    font-size: var(--font-size-sm);
  }

  .page-content-wrapper :is(th, td) {
    padding: var(--space-3) var(--space-4);
  }

  .sidebar-widget {
    grid-template-columns: 1fr;
  }
}

/* -----------------------------------------------------------------------
     MODO OSCURO COMPLETO - ULTRA ESPECÍFICO Y FORZADO PARA PAGES.CSS
     ----------------------------------------------------------------------- */

/* Variables de modo oscuro - FORZADO PARA PAGES.CSS */
:root[data-theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
html.dark-mode,
body.dark-mode,
*[data-theme="dark"],
*[data-theme="dark"] * {
  --color-background: #0f172a !important;
  --color-surface: #1e293b !important;
  --color-surface-elevated: #334155 !important;
  --color-text-primary: #f1f5f9 !important;
  --color-text-secondary: #cbd5e1 !important;
  --color-text-muted: #94a3b8 !important;
  --color-border: #475569 !important;
  --color-border-strong: #475569 !important;
  --color-border-light: #334155 !important;
  --color-primary: #60a5fa !important;
  --color-primary-50: #1e3a8a !important;
  --color-primary-200: #3b82f6 !important;
  --color-primary-600: #3b82f6 !important;
  color-scheme: dark !important;
}

/* FONDO GENERAL Y BODY */
:root[data-theme="dark"] body,
html[data-theme="dark"] body,
body[data-theme="dark"],
:root[data-theme="dark"] html,
html[data-theme="dark"] html,
body[data-theme="dark"] html,
html.dark-mode body,
body.dark-mode,
html.dark-mode,
*[data-theme="dark"] body,
*[data-theme="dark"] html {
  background: #0f172a !important;
  color: #f1f5f9 !important;
  background-color: #0f172a !important;
}

/* CONTENEDORES PRINCIPALES */
:root[data-theme="dark"] .pagina-wrapper,
:root[data-theme="dark"] .page-container,
:root[data-theme="dark"] .site-main,
html[data-theme="dark"] .pagina-wrapper,
html[data-theme="dark"] .page-container,
html[data-theme="dark"] .site-main,
body[data-theme="dark"] .pagina-wrapper,
body[data-theme="dark"] .page-container,
body[data-theme="dark"] .site-main,
html.dark-mode .pagina-wrapper,
html.dark-mode .page-container,
html.dark-mode .site-main,
body.dark-mode .pagina-wrapper,
body.dark-mode .page-container,
body.dark-mode .site-main {
  background: #0f172a !important;
  color: #f1f5f9 !important;
}

/* CONTENIDO DE PÁGINAS Y ENTRADAS */
:root[data-theme="dark"] .page-content,
:root[data-theme="dark"] .page-main-content,
:root[data-theme="dark"] .page-content-wrapper,
:root[data-theme="dark"] .entrada-simple .page-content-wrapper,
:root[data-theme="dark"] .wp-block-post-content,
:root[data-theme="dark"] .entry-content,
:root[data-theme="dark"] .contenido-principal,
:root[data-theme="dark"] .lesson-content-wrapper,
:root[data-theme="dark"] .leccion-contenido,
html[data-theme="dark"] .page-content,
html[data-theme="dark"] .page-main-content,
html[data-theme="dark"] .page-content-wrapper,
html[data-theme="dark"] .entrada-simple .page-content-wrapper,
html[data-theme="dark"] .wp-block-post-content,
html[data-theme="dark"] .entry-content,
html[data-theme="dark"] .contenido-principal,
html[data-theme="dark"] .lesson-content-wrapper,
html[data-theme="dark"] .leccion-contenido,
body[data-theme="dark"] .page-content,
body[data-theme="dark"] .page-main-content,
body[data-theme="dark"] .page-content-wrapper,
body[data-theme="dark"] .entrada-simple .page-content-wrapper,
body[data-theme="dark"] .wp-block-post-content,
body[data-theme="dark"] .entry-content,
body[data-theme="dark"] .contenido-principal,
body[data-theme="dark"] .lesson-content-wrapper,
body[data-theme="dark"] .leccion-contenido,
html.dark-mode .page-content,
html.dark-mode .page-main-content,
html.dark-mode .page-content-wrapper,
html.dark-mode .entrada-simple .page-content-wrapper,
html.dark-mode .wp-block-post-content,
html.dark-mode .entry-content,
html.dark-mode .contenido-principal,
html.dark-mode .lesson-content-wrapper,
html.dark-mode .leccion-contenido,
body.dark-mode .page-content,
body.dark-mode .page-main-content,
body.dark-mode .page-content-wrapper,
body.dark-mode .entrada-simple .page-content-wrapper,
body.dark-mode .wp-block-post-content,
body.dark-mode .entry-content,
body.dark-mode .contenido-principal,
body.dark-mode .lesson-content-wrapper,
body.dark-mode .leccion-contenido {
  background: #1e293b !important;
  color: #f1f5f9 !important;
  border-color: #475569 !important;
  box-shadow: 0 1px 2px rgba(0, 0, 0, .4), 0 12px 40px rgba(0, 0, 0, .5) !important;
}

/* PÁRRAFOS Y TEXTO - ULTRA ESPECÍFICO */
:root[data-theme="dark"] .wp-block-post-content p,
:root[data-theme="dark"] .entry-content p,
:root[data-theme="dark"] .page-content-wrapper p,
:root[data-theme="dark"] .contenido-principal p,
:root[data-theme="dark"] .leccion-contenido p,
:root[data-theme="dark"] .wp-block-post-content li,
:root[data-theme="dark"] .entry-content li,
:root[data-theme="dark"] .page-content-wrapper li,
:root[data-theme="dark"] .contenido-principal li,
:root[data-theme="dark"] .leccion-contenido li,
:root[data-theme="dark"] .wp-block-post-content strong,
:root[data-theme="dark"] .entry-content strong,
:root[data-theme="dark"] .page-content-wrapper strong,
:root[data-theme="dark"] .contenido-principal strong,
:root[data-theme="dark"] .leccion-contenido strong,
html[data-theme="dark"] .wp-block-post-content p,
html[data-theme="dark"] .entry-content p,
html[data-theme="dark"] .page-content-wrapper p,
html[data-theme="dark"] .contenido-principal p,
html[data-theme="dark"] .leccion-contenido p,
html[data-theme="dark"] .wp-block-post-content li,
html[data-theme="dark"] .entry-content li,
html[data-theme="dark"] .page-content-wrapper li,
html[data-theme="dark"] .contenido-principal li,
html[data-theme="dark"] .leccion-contenido li,
html[data-theme="dark"] .wp-block-post-content strong,
html[data-theme="dark"] .entry-content strong,
html[data-theme="dark"] .page-content-wrapper strong,
html[data-theme="dark"] .contenido-principal strong,
html[data-theme="dark"] .leccion-contenido strong,
body[data-theme="dark"] .wp-block-post-content p,
body[data-theme="dark"] .entry-content p,
body[data-theme="dark"] .page-content-wrapper p,
body[data-theme="dark"] .contenido-principal p,
body[data-theme="dark"] .leccion-contenido p,
body[data-theme="dark"] .wp-block-post-content li,
body[data-theme="dark"] .entry-content li,
body[data-theme="dark"] .page-content-wrapper li,
body[data-theme="dark"] .contenido-principal li,
body[data-theme="dark"] .leccion-contenido li,
body[data-theme="dark"] .wp-block-post-content strong,
body[data-theme="dark"] .entry-content strong,
body[data-theme="dark"] .page-content-wrapper strong,
body[data-theme="dark"] .contenido-principal strong,
body[data-theme="dark"] .leccion-contenido strong,
html.dark-mode .wp-block-post-content p,
html.dark-mode .entry-content p,
html.dark-mode .page-content-wrapper p,
html.dark-mode .contenido-principal p,
html.dark-mode .leccion-contenido p,
html.dark-mode .wp-block-post-content li,
html.dark-mode .entry-content li,
html.dark-mode .page-content-wrapper li,
html.dark-mode .contenido-principal li,
html.dark-mode .leccion-contenido li,
html.dark-mode .wp-block-post-content strong,
html.dark-mode .entry-content strong,
html.dark-mode .page-content-wrapper strong,
html.dark-mode .contenido-principal strong,
html.dark-mode .leccion-contenido strong,
body.dark-mode .wp-block-post-content p,
body.dark-mode .entry-content p,
body.dark-mode .page-content-wrapper p,
body.dark-mode .contenido-principal p,
body.dark-mode .leccion-contenido p,
body.dark-mode .wp-block-post-content li,
body.dark-mode .entry-content li,
body.dark-mode .page-content-wrapper li,
body.dark-mode .contenido-principal li,
body.dark-mode .leccion-contenido li,
body.dark-mode .wp-block-post-content strong,
body.dark-mode .entry-content strong,
body.dark-mode .page-content-wrapper strong,
body.dark-mode .contenido-principal strong,
body.dark-mode .leccion-contenido strong {
  color: #cbd5e1 !important;
}

/* HEADERS Y SIDEBARS */
:root[data-theme="dark"] .page .page-header,
:root[data-theme="dark"] .sidebar-widget-header,
:root[data-theme="dark"] .sidebar-widget,
html[data-theme="dark"] .page .page-header,
html[data-theme="dark"] .sidebar-widget-header,
html[data-theme="dark"] .sidebar-widget,
body[data-theme="dark"] .page .page-header,
body[data-theme="dark"] .sidebar-widget-header,
body[data-theme="dark"] .sidebar-widget,
html.dark-mode .page .page-header,
html.dark-mode .sidebar-widget-header,
html.dark-mode .sidebar-widget,
body.dark-mode .page .page-header,
body.dark-mode .sidebar-widget-header,
body.dark-mode .sidebar-widget {
  background: #1e293b !important;
  color: #f1f5f9 !important;
  border-color: #475569 !important;
}

/* CÓDIGO Y PRE - ULTRA ESPECÍFICO */
:root[data-theme="dark"] .wp-block-post-content code,
:root[data-theme="dark"] .entry-content code,
:root[data-theme="dark"] .page-content-wrapper code,
:root[data-theme="dark"] .contenido-principal code,
:root[data-theme="dark"] .leccion-contenido code,
html[data-theme="dark"] .wp-block-post-content code,
html[data-theme="dark"] .entry-content code,
html[data-theme="dark"] .page-content-wrapper code,
html[data-theme="dark"] .contenido-principal code,
html[data-theme="dark"] .leccion-contenido code,
body[data-theme="dark"] .wp-block-post-content code,
body[data-theme="dark"] .entry-content code,
body[data-theme="dark"] .page-content-wrapper code,
body[data-theme="dark"] .contenido-principal code,
body[data-theme="dark"] .leccion-contenido code,
html.dark-mode .wp-block-post-content code,
html.dark-mode .entry-content code,
html.dark-mode .page-content-wrapper code,
html.dark-mode .contenido-principal code,
html.dark-mode .leccion-contenido code,
body.dark-mode .wp-block-post-content code,
body.dark-mode .entry-content code,
body.dark-mode .page-content-wrapper code,
body.dark-mode .contenido-principal code,
body.dark-mode .leccion-contenido code {
  background: #0b1220 !important;
  color: #e5e7eb !important;
  border-color: #374151 !important;
}

/* ELIMINADO: Dark mode complicado que rompía todo
   Highlight.js maneja automáticamente light/dark con sus CSS */

/* ENLACES - ULTRA ESPECÍFICO */
:root[data-theme="dark"] .page-content-wrapper a,
:root[data-theme="dark"] .wp-block-post-content a,
:root[data-theme="dark"] .entry-content a,
html[data-theme="dark"] .page-content-wrapper a,
html[data-theme="dark"] .wp-block-post-content a,
html[data-theme="dark"] .entry-content a,
body[data-theme="dark"] .page-content-wrapper a,
body[data-theme="dark"] .wp-block-post-content a,
body[data-theme="dark"] .entry-content a,
html.dark-mode .page-content-wrapper a,
html.dark-mode .wp-block-post-content a,
html.dark-mode .entry-content a,
body.dark-mode .page-content-wrapper a,
body.dark-mode .wp-block-post-content a,
body.dark-mode .entry-content a {
  color: #60a5fa !important;
}

:root[data-theme="dark"] .page-content-wrapper thead th {
  background: color-mix(in srgb, var(--color-primary-600) 22%, #0b1020);
  color: #e5e7eb;
  border-bottom-color: #273143;
}

:root[data-theme="dark"] .page-content-wrapper tr:hover {
  background: color-mix(in srgb, #ffffff 4%, #0b1020);
}

:root[data-theme="dark"] .page-navigation {
  background: color-mix(in srgb, #ffffff 4%, #0b1020);
  border-color: color-mix(in srgb, #ffffff 10%, #0b1020);
}

:root[data-theme="dark"] .page-nav-link {
  background: #0b1020;
  border-color: color-mix(in srgb, #ffffff 12%, #0b1020);
}

/* TÍTULOS Y ENCABEZADOS - ULTRA ESPECÍFICO */
:root[data-theme="dark"] .page-title,
:root[data-theme="dark"] .page .page-header__title,
:root[data-theme="dark"] .wp-block-post-content h1,
:root[data-theme="dark"] .entry-content h1,
:root[data-theme="dark"] .page-content-wrapper h1,
:root[data-theme="dark"] .contenido-principal h1,
:root[data-theme="dark"] .leccion-contenido h1,
:root[data-theme="dark"] .wp-block-post-content h2,
:root[data-theme="dark"] .entry-content h2,
:root[data-theme="dark"] .page-content-wrapper h2,
:root[data-theme="dark"] .contenido-principal h2,
:root[data-theme="dark"] .leccion-contenido h2,
:root[data-theme="dark"] .wp-block-post-content h3,
:root[data-theme="dark"] .entry-content h3,
:root[data-theme="dark"] .page-content-wrapper h3,
:root[data-theme="dark"] .contenido-principal h3,
:root[data-theme="dark"] .leccion-contenido h3,
html[data-theme="dark"] .page-title,
html[data-theme="dark"] .page .page-header__title,
html[data-theme="dark"] .wp-block-post-content h1,
html[data-theme="dark"] .entry-content h1,
html[data-theme="dark"] .page-content-wrapper h1,
html[data-theme="dark"] .contenido-principal h1,
html[data-theme="dark"] .leccion-contenido h1,
html[data-theme="dark"] .wp-block-post-content h2,
html[data-theme="dark"] .entry-content h2,
html[data-theme="dark"] .page-content-wrapper h2,
html[data-theme="dark"] .contenido-principal h2,
html[data-theme="dark"] .leccion-contenido h2,
html[data-theme="dark"] .wp-block-post-content h3,
html[data-theme="dark"] .entry-content h3,
html[data-theme="dark"] .page-content-wrapper h3,
html[data-theme="dark"] .contenido-principal h3,
html[data-theme="dark"] .leccion-contenido h3,
body[data-theme="dark"] .page-title,
body[data-theme="dark"] .page .page-header__title,
body[data-theme="dark"] .wp-block-post-content h1,
body[data-theme="dark"] .entry-content h1,
body[data-theme="dark"] .page-content-wrapper h1,
body[data-theme="dark"] .contenido-principal h1,
body[data-theme="dark"] .leccion-contenido h1,
body[data-theme="dark"] .wp-block-post-content h2,
body[data-theme="dark"] .entry-content h2,
body[data-theme="dark"] .page-content-wrapper h2,
body[data-theme="dark"] .contenido-principal h2,
body[data-theme="dark"] .leccion-contenido h2,
body[data-theme="dark"] .wp-block-post-content h3,
body[data-theme="dark"] .entry-content h3,
body[data-theme="dark"] .page-content-wrapper h3,
body[data-theme="dark"] .contenido-principal h3,
body[data-theme="dark"] .leccion-contenido h3,
html.dark-mode .page-title,
html.dark-mode .page .page-header__title,
html.dark-mode .wp-block-post-content h1,
html.dark-mode .entry-content h1,
html.dark-mode .page-content-wrapper h1,
html.dark-mode .contenido-principal h1,
html.dark-mode .leccion-contenido h1,
html.dark-mode .wp-block-post-content h2,
html.dark-mode .entry-content h2,
html.dark-mode .page-content-wrapper h2,
html.dark-mode .contenido-principal h2,
html.dark-mode .leccion-contenido h2,
html.dark-mode .wp-block-post-content h3,
html.dark-mode .entry-content h3,
html.dark-mode .page-content-wrapper h3,
html.dark-mode .contenido-principal h3,
html.dark-mode .leccion-contenido h3,
body.dark-mode .page-title,
body.dark-mode .page .page-header__title,
body.dark-mode .wp-block-post-content h1,
body.dark-mode .entry-content h1,
body.dark-mode .page-content-wrapper h1,
body.dark-mode .contenido-principal h1,
body.dark-mode .leccion-contenido h1,
body.dark-mode .wp-block-post-content h2,
body.dark-mode .entry-content h2,
body.dark-mode .page-content-wrapper h2,
body.dark-mode .contenido-principal h2,
body.dark-mode .leccion-contenido h2,
body.dark-mode .wp-block-post-content h3,
body.dark-mode .entry-content h3,
body.dark-mode .page-content-wrapper h3,
body.dark-mode .contenido-principal h3,
body.dark-mode .leccion-contenido h3 {
  background: linear-gradient(90deg, #c7d2fe, #818cf8) !important;
  -webkit-background-clip: text !important;
  background-clip: text !important;
  -webkit-text-fill-color: transparent !important;
  color: #f1f5f9 !important;
}

/* Alertas en dark */
:root[data-theme="dark"] .page-alert--info {
  background: color-mix(in srgb, var(--color-info) 12%, #0b1020);
  border-color: color-mix(in srgb, var(--color-info) 35%, #0b1020);
}

:root[data-theme="dark"] .page-alert--success {
  background: color-mix(in srgb, var(--color-success) 12%, #0b1020);
  border-color: color-mix(in srgb, var(--color-success) 35%, #0b1020);
}

:root[data-theme="dark"] .page-alert--warning {
  background: color-mix(in srgb, var(--color-warning) 12%, #0b1020);
  border-color: color-mix(in srgb, var(--color-warning) 35%, #0b1020);
}

:root[data-theme="dark"] .page-alert--error {
  background: color-mix(in srgb, var(--color-error) 12%, #0b1020);
  border-color: color-mix(in srgb, var(--color-error) 35%, #0b1020);
}

/* =======================================
   MATHJAX LIMPIO Y MINIMALISTA
   ======================================= */

/* MathJax sin decoraciones innecesarias */
mjx-container {
  font-size: 1.1em !important;
  line-height: 1.6 !important;
  margin: 1.5rem 0 !important;
}

mjx-container[display="true"] {
  text-align: center !important;
}

/* Dark mode para MathJax */
:root[data-theme="dark"] .mjx-chtml,
html[data-theme="dark"] .mjx-chtml,
body[data-theme="dark"] .mjx-chtml,
html.dark-mode .mjx-chtml,
body.dark-mode .mjx-chtml {
  color: #f1f5f9 !important;
}

/* -----------------------------------------------------------------------
     MathJax v3 (CHTML) — coherente con hoja anterior y contenedores WP
     ----------------------------------------------------------------------- */
:where(.wp-block-post-content, .entry-content, .page-content-wrapper) .mjx-chtml,
:where(.contenido-principal, .leccion-contenido) .mjx-chtml {
  color: var(--color-text-primary);
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) .mjx-container[jax="CHTML"] {
  line-height: 1.22;
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) .mjx-chtml.MathJax_CHTML_Display,
:where(.wp-block-post-content, .entry-content, .page-content-wrapper) .MathJax_Display,
:where(.contenido-principal, .leccion-contenido) .mjx-chtml.MathJax_CHTML_Display {
  margin-block: 1.25em;
  text-align: center;
  overflow-x: auto;
  overflow-y: visible;
  padding-inline: .25rem;
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) .mjx-tag {
  color: var(--color-text-muted);
  padding-inline-start: .75rem;
  min-inline-size: 3ch;
  text-align: end;
}

:where(.wp-block-post-content, .entry-content, .page-content-wrapper) .mjx-mtd[tabindex="0"] {
  outline: none;
}

/* -----------------------------------------------------------------------
     Animaciones y microinteracciones (respetando reduced-motion)
     ----------------------------------------------------------------------- */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.page-content {
  animation: none;
}

@media (prefers-reduced-motion: no-preference) {
  .page-content-wrapper>* {
    animation: fadeInUp .4s var(--transition-timing) both;
  }

  .page-content-wrapper>*:nth-child(2) {
    animation-delay: .1s;
  }

  .page-content-wrapper>*:nth-child(3) {
    animation-delay: .2s;
  }

  .page-content-wrapper>*:nth-child(4) {
    animation-delay: .3s;
  }

  .page-content-wrapper>*:nth-child(5) {
    animation-delay: .4s;
  }
}

/* Scroll suave y selección */
html {
  scroll-behavior: smooth;
}

::selection {
  background: var(--color-primary-200);
  color: var(--color-primary);
}

/* -----------------------------------------------------------------------
     Impresión (PDF/print-friendly)
     ----------------------------------------------------------------------- */
@media print {
  :root {
    --color-text-primary: #000;
    --color-text-secondary: #222;
    --color-text-muted: #444;
  }

  .pagina-wrapper,
  .page-content-wrapper,
  .page .page-header,
  figure,
  .page-alert,
  .sidebar-widget {
    box-shadow: none !important;
    background: #fff !important;
  }

  .page .page-header__title,
  .page-title {
    -webkit-text-fill-color: currentColor !important;
    background: none !important;
    color: #000 !important;
  }

  a {
    text-decoration: none;
    color: #000;
  }

  pre {
    border: 1px solid #bbb;
  }

  p,
  blockquote {
    orphans: 3;
    widows: 3;
  }
}